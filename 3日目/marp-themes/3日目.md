---
marp: true
theme: test
class:
  - slide
---

<!-- paginate: true -->

# AI研究会第3回

---

## 目次

* Pythonとは
* データ型
* オブジェクト
* 全てはオブジェクト
* マジックメソッド

---

## Pythonとは？

プログラミング言語の一つ。AI開発は大体Pythonで行われる。理由としては

* ライブラリが豊富
* 比較的簡単な文法で学習コストが低い
* 必然的に可読性が高くなる
* C言語で書いて関数も実行できるので、多次元配列オブジェクト（ndarray）や数値演算の関数は、C言語で書くことでインタープリタ型の言語にもかかわらず高速なコードを活用できる。

などがある。

--- 

## データ型

c言語と同様に、pythonも変数にデータ型という概念が存在する。ただし、c言語のように「int型」というよりは「intオブジェクト」といったほうが正確である。さらに正確に言うなら、pythonはすべてがオブジェクトであり、変数はそのオブジェクトのポインタを保存している。ただしこのあたりの話はオブジェクトを知らないことには始まらないので後で説明する。

---

## 数値型 

* 整数型 (int): 整数を表します。
```python
num = 10
```
* 浮動小数点型 (float): 小数点以下を含む数を表します。
```python
num = 3.14
```

* 複素数型 (complex): 実数部と虚数部からなる複素数を表します。
```python
num = 2 + 3j
```

---

## 文字列型、真偽型

* 文字列型 (str): 文字やテキスト(文字列)を表します。
```python
text = "Hello, World!"
```

* 真偽型 (bool): 真(True)または偽(False)を表します。
```python
is_true = True
is_false = False
```

---

## シーケンス型

* リスト型 (list): 要素の順序付き集合です。要素は異なるデータ型を持つことができます。配列とは若干違いますが、配列と思ってもそこまで間違えではありません。

```python
my_list = [1, 2, 3, "apple", "banana",True]
```
* タプル型 (tuple): 要素の順序付き集合ですが、一度定義すると変更できません。
```python
my_list = [1, 2, 3, "apple", "banana",True]
```
取り出し方はどちらも同じで、index番号を指定します。例えば`my_list[3]`とすると`"apple"`という文字列が取り出せます。


---

## 辞書型

* 辞書型 (dict): キーと値のペアでデータを格納します。
```python
my_dict = {"name": "John", "age": 30, "city": "Tokyo"}
```

取り出し方は、keyを指定します。例えば`my_dict['name']`とすると`"John"`が取り出せます。

---

## プログラムとメインメモリ

少し一般論的な話になるが、メインメモリとプログラムの関係について解説する。

ソースコードをメインメモリに持ってこないとCPUはそのプログラムを実行できない。なのでプログラムを実行するときにはソースコードはメインメモリにのっている状態でなければならない。

半分余談だが、メインメモリは以下のような領域に分かれている。

* 静的領域(グローバル変数などが格納。プログラム終了時に開放される)
* ヒープ領域(動的に割り当てるメモリを変化できる領域。オブジェクト(インスタンス)はここに保存される。)
* スタック領域(関数(main関数も含む)やローカル変数が格納される。)

---

## クラスとオブジェクト

変数や関数をひとまとめにしたい状況というのはよく発生する。"モノ"は一般に複数の属性を持っていて、変数一つでは特定のモノを変数に代入することはできない。機会学習(Pytorch)ではクラスとオブジェクトは必ず出てくるのでしっかり理解してほしい。よくある説明になってしますが、日常的な例で直感的に説明する。

例えば、人の情報は"名前"だけではなく以下のようなもの普通扱う。

* 名前、年齢、性別、得意なこと…etc

ここでその人の情報を変数に入れることを考える。

人の絵

---

## クラスとオブジェクト

```python
person1_name = "鈴木"
person1_age = 22
person1_gender = "male"
```
などである。ここで誕生日が来た時を考えよう。`person1_age`を更新しなくてはならない。
```python
def birthday(age):
    return age+1
person1_age = birthday(person1_age)
```
人が一人ならまだしも、複数人いる場合はあまりいい方法ではないだろう。

---

## クラスとオブジェクト

人の情報(及び関数)はどこか一箇所にまとめて一元管理したくなる。そこで使えるのがクラス及びオブジェクトという概念である。
```python
class MyClass:
    def __init__(self,name,age,gender):                  # コンストラクタ
        self.name = name
        self.age = age
        self.gender = gender
    def birthday(self):
        self.age = self.age + 1

person = MyClass("鈴木",22,"male")                  # クラスのインスタンスを生成
person.birthday()                                   # 誕生日が来たため年齢+1
```

次ページに図を示す。

---

## クラスとオブジェクト

クラスはオブジェクトの設計図であり、オブジェクトはクラスを元に作られた実態(つまりプログラムを実行するためにメインメモリに格納された状態)である。


----

## オブジェクト

オブジェクトは一般的にインスタンスと呼ばれる。また、オブジェクト内部の関数(先程の例だと`birthday`)をメソッド、オブジェクト内部の変数(先程例だと、`self.name`,`self.age`,`self.gender`)をプロパティと呼び、メソッドとプロパティを合わせて属性(attribute)と呼ぶ。

メソッドにアクセス(書き換えたり、参照すること)したい場合`.`を通じて行う。
```python
# 省略
person = MyClass("鈴木",22,"male")                  # クラスのインスタンスを生成
person.name = "涼木"                                # プロパティの変更
person.birthday()                                   # 誕生日が来たため年齢+1
```

---

## 全てがオブジェクト？

実はpythonは全てがオブジェクトである。type関数でそれがなんのクラスから作られたオブジェクトかわかるので確認してみよう。

例えば`1`はint型オブジェクトでint型オブジェクトは`__add__()`というメソッドを持っている。`__`で囲まれたメソッドは特殊なメソッドで演算子(`+`とか)や組み込み関数(元からある関数のこと)がメソッドに作用した時に実行される関数である。

`1`というint型オブジェクトに演算子`+`を作用させることは、`1 .__add__()`を呼び出すことに等しい。実験してみよう。
```python
print(1+2)
print(1 .__add__(2)) #1の後に半角スペースをいれないと構文エラーになるので注意
```

---

## 全てがオブジェクト

全てがオブジェクトというのはこれでわかったと思う。演算子(比較演算子や算術演算子)や組み込み関数、さらにはfor文の挙動も実は`__`で囲まれたメソッドは特殊なメソッド(マジックメソッドといいます)で定義されている。なので(あくまで私は)pythonの本質はオブジェクトを理解することだと思っている。

では変数とは何を格納しているのだろうか。実はオブジェクトには一意のIDがふられている。このIDを保管するのがpythonで言うところの変数に対応する。なのでc言語のように型宣言しなくても変数に何でも保存できている。

---

## より発展的な内容

例えば、for文はイテレータやイテラブルオブジェクトといったものにマジックメソッド`__iter__()`や`__next__()`を作用させることで実現できる。

[公式サイト](https://docs.python.org/ja/3/reference/datamodel.html)で`ctrl+f`を押して`object.__`で検索してみよう。本当にいろんなマジックメソッドが定義されていることがわかる。次ページににその例を、噛み砕いた説明で載せておく。

---

## マジックメソッド

|マジックメソッド|対応するもの|機能|
|----|----|----|
|\_\_str__|print(object)|文字列に直す関数(`1→'1'`など)|
|\_\_lt__|x<y は x.\_\_lt__(y)|x<y としたときに呼び出される関数|
|\_\_iter__|for文を呼んだ時|イテレーターを返す関数。\_\_iter__が実装されているオブジェクトをイテラブルという。|
|\_\_next__|for文を呼んだ時|次の要素を返す関数。for文で回すときに使われる。|


---

## マジックメソッド

|マジックメソッド|対応するもの|機能|
|----|----|----|
|\_\_getitem__|object(index_num)|配列のindex番号を指定した際に値を参照する関数|
|\_\_call__|object()|オブジェクトに関数呼び出し演算子`()`を作用させた時の呼ばれる関数|

[この本](https://www.oreilly.co.jp/books/9784873118178/)などを読めばもっと理解できるのでしょうが私はまだ読んでません。もしかしたら私もまだ本質が見えていない可能性もあります。

---

## 次回予告

今回は変数及びオブジェクトについて学びました。次回は構文や式について学ぼうと思います。






